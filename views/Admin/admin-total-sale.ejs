<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Total Sales | Rider Admin</title>
    <link rel="stylesheet" href="/css/admin-newoder.css" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div
      class="sidebar-overlay"
      id="sidebarOverlay"
      onclick="toggleSidebar()"
    ></div>

    <header class="mobile-header">
      <span style="font-weight: 800; font-size: 1.2rem"
        ><%-admin.username%></span
      >
      <i
        class="fa-solid fa-bars"
        style="font-size: 1.5rem; cursor: pointer"
        onclick="toggleSidebar()"
      ></i>
    </header>

    <%- include("../partials/adminNavBar") %>

    <main class="main-content">
      <h1>ðŸ’° Total Sales</h1>
      <p>Total Sales Amount: <strong>â‚¹<%= totalSales %></strong></p>

      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Order ID</th>
              <th>User</th>
              <th>Products</th>
              <th>Total Amount</th>
              <th>Payment</th>
              <th>Status</th>
              <th>Date</th>
            </tr>
          </thead>
          <tbody>
            <% if (orders.length === 0) { %>
            <tr>
              <td colspan="7" style="text-align: center; padding: 20px">
                No Orders Yet
              </td>
            </tr>
            <% } %> <% orders.forEach(order => { %>
            <tr>
              <td>#<%= order._id.toString().slice(-6).toUpperCase() %></td>

              <td>
                <%= order.user?.username || "Guest" %><br />
                <small><%= order.user?.phoneNo || order.mobile %></small>
              </td>

              <td>
                <% order.items.forEach(item => { %>
                <div
                  style="
                    display: flex;
                    gap: 10px;
                    margin-bottom: 8px;
                    align-items: center;
                  "
                >
                  <img
                    src="<%= item.product.images[0] %>"
                    width="45"
                    style="border-radius: 6px"
                  />
                  <div>
                    <strong><%= item.product.title %></strong><br />
                    <small
                      >Qty: <%= item.qty %> <% if(item.size){ %>| Size: <%=
                      item.size %> <% } %></small
                    >
                  </div>
                </div>
                <% }) %>
              </td>

              <td>â‚¹<%= order.totalAmount %></td>

              <td>
                <%= order.paymentMethod %> <br />
                <small><%= order.paymentStatus %></small>
              </td>

              <td>
                <% if(order.orderStatus === "Confirmed"){ %>
                <span style="color: orange; font-weight: bold">Confirmed</span>
                <% } else if(order.orderStatus === "Pending"){ %>
                <span style="color: gray; font-weight: bold">Pending</span>
                <% } else if(order.orderStatus === "Shipped"){ %>
                <span style="color: blue; font-weight: bold">Shipped</span>
                <% } else if(order.orderStatus === "Delivered"){ %>
                <span style="color: green; font-weight: bold">Delivered</span>
                <% } %>
              </td>

              <td>
                <%= new Date(order.createdAt).toLocaleDateString("en-IN") %>
              </td>
            </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    </main>
    <script src="/js/shoesProduct.js"></script>
  </body>
</html>
